# Bayesian Network Problem (Casual Belief network)

### problem
```
Consider a medical test for a certain disease that is very rare, striking only 1 in 100,000 people. Suppose the probability of testing positive if the person has the disease is 99%, as is the probability of testing negative when the person does not have the disease.

Express these facts in the form of a (causal) belief network. Use variable names 'Disease' and 'Test'. Assign the network to the variable network.
```

## working
### prob calculations:
- Disease Prevalence
  - P(Disease = True) = 1/100,000 = 0.00001
  - P(Disease = False) = 1 - 0.00001 = 0.99999

- Test Characteristics
  - Sensitivity: Prob of testing positive given person has disease
    - P(Test = True | Disease = True) = 0.99 (FROM QUESTION DESCRIPTION)
  - Specificity: Prob of testing negative given person does not have disease
    - P(Test = False | Disease = False) = 0.99 (FROM QUESTION DESCRIPTION)
  - False Positive Rate
    - P(Test = True | Disease = False) = 1 - Specificity = 1 - 0.99 = 0.01

### bayesian network construction
- Variables
  - Disease: Person has or hasn't got it (True/False)
  - Test: Result of test (True/False)
- Structure
  - Disease is root node (No parents) (WHY? Not dependent on anything)
  - Test is child node (Dependent on disease) 

- Conditional probability tables (CPT)
  - Disease Node CPT:

|Disease|Probability|
|-------|-----------|
|True|0.00001|
|False|0.99999|

  - Test Node CPT:

|Disease|Test|Probability P(Test\|Disease)|
|-------|----|---------------------------|
|True|True|0.99|
|True|False|0.01|
|False|True|0.01|
|False|False|0.99|

- Code 
```
network = {
    'Disease': {
        'Parents': [],
        'CPT': {
            (): 0.00001 #P(Disease = True) #NOTE: () as no parents
        }
    },
    'Test': {
        'Parents': ['Disease'],
        'CPT': {
            (True,): 0.99, # P(Test=True | Disease=True) #NOTE: () is parent value
            (False,): 0.01 # P(Test=True | Disease=False)
        }
    }
}
```

### answer result
- After running join_prob and query the results are:
```
The probability of having the disease if the test comes back positive: 
0.00098903

The probability of having the disease if the test comes back negative: 
0.00000010
```

### Explain and justify results of model
- why is the prob of a positive test when you have the disease so low?
  - Because the P(Disease=True) is extremely low, even with a high sensitivity and specificity, the posterior probability remains low
    - Effects of specificity
      - The false positive rate of 1% is significant compared to disease prevalence
      - Improving specificity (reducing false positive rate) would increase the posterior probability

